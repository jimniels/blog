---
(site) => {
  posts = site.posts
    -> (posts) => Tree.filter(posts, (post) => post.hasOwnProperty("pageviews"))
    -> (posts) => Tree.sort(posts, (a, b) => (a.pageviews > b.pageviews ? -1 : 1))
    -> Tree.values
    -> Tree.plain
  
  page: {
    title: "Trending Posts",
    path: "/posts/trending/",
  },
  
  return = <server/Layouts.js>.Page({ site, page }, _template())
}.return
---

<main class="wrapper">
  <h1>Posts</h1>
  ${<server/PostsNav.js>(page.path)}

  <!-- prettier-ignore -->
  ${<server/PostsList.js>(posts)}

  <p class="posts-nav-note">
    FYI: pageviews are based on the last 30 days of
    <a
      href="/2020/using-netlify-analytics-to-build-list-of-popular-posts/"
      style="text-decoration: underline; color: inherit"
      >analytics data I get from Netlify</a
    >.
  </p>
</main>
